@using ServerMVC.Models
@model IQueryable<Measurement>
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    Layout = null;
}

<!DOCTYPE html>
<html class="page" lang="ru">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial scale=1">
    <title>Метеостанция Меньково</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="icon" href="favicon.ico">
</head>

<body class="page__body">
    <div class="page__container">
        <header class="main-header">
            <div class="main-header__top">
                @{
                    //DateTime.Now.ToString("yyyy-MM-dd")
                    var calendar = Html.TextBox("Name", "2023-09-06" , new { @class = "main-header__calendar", @type = "date", @id = "calendar", @name = "calendarInput" });
                }
                @calendar
                <input type="submit" onclick="location.href='@Url.Action("Index", "Home")'" value="Главная" />
                @* <input class="main-header__calendar" type="date" id="calendar" name="calendarInput" value="2023-10-27"> *@
                <img src="/img/agrophysLogo.png" alt="Логотип АФИ">
                <input type="submit" onclick="location.href='@Url.Action("FieldMap", "Home")'" value="Датчики" />
                <button id="ID">Войти</button>
            </div>
            <img class="main-header__fieldimg" src="/img/dayOfTheField.png" alt="День поля">
        </header>
        <main class="main-info">
            <h1 class="visually-hidden">Сайт метеостанции поля в Меньково</h1>
            <div class="chart-area">
                <div class="chart-area__concrete">
                    <fieldset class="main-info__form form">
                        <legend class="form__legend">Отобразить t воздуха за:</legend>
                        <div class="form__choice-wrapper">
                            <div class="form__radio-wrapper">
                                <input class="form__radio" type="radio" id="oneTW" name="TW" value="1" checked />
                                <label class="form__choice-description" for="oneTW">1 день</label>
                            </div>
                            <div class="form__radio-wrapper">
                                <input class="form__radio" type="radio" id="threeTW" name="TW" value="3" onchange="" />
                                <label class="form__choice-description" for="threeTW">3 дня</label>
                            </div>
                        </div>
                        <div class="form__chart form__chart--twind"></div>
                    </fieldset>
                </div>
                <div class="chart-area__concrete">
                    <fieldset class="main-info__form form">
                        <legend class="form__legend">Отобразить p воздуха за:</legend>
                        <div class="form__choice-wrapper">
                            <div class="form__radio-wrapper">
                                <input class="form__radio" type="radio" id="onePW" name="PW" value="1" checked />
                                <label class="form__choice-description" for="onePW">1 день</label>
                            </div>
                            <div class="form__radio-wrapper">
                                <input class="form__radio" type="radio" id="threePW" name="PW" value="3" />
                                <label class="form__choice-description" for="threePW">3 дня</label>
                            </div>
                        </div>
                        <div class="form__chart form__chart--pwind"></div>
                    </fieldset>
                </div>
                <div class="chart-area__concrete">
                    <fieldset class="main-info__form form">
                        <legend class="form__legend">Отобразить t почвы за:</legend>
                        <div class="form__choice-wrapper">
                            <div class="form__radio-wrapper">
                                <input class="form__radio" type="radio" id="oneTS" name="TS" value="1" checked />
                                <label class="form__choice-description" for="oneTS">1 день</label>
                            </div>
                            <div class="form__radio-wrapper">
                                <input class="form__radio" type="radio" id="threeTS" name="TS" value="3" />
                                <label class="form__choice-description" for="threeTS">3 дня</label>
                            </div>
                        </div>
                        <div class="form__chart form__chart--tpov"></div>
                    </fieldset>
                </div>
                <div class="chart-area__concrete">
                    <fieldset class="main-info__form form">
                        <legend class="form__legend">Скорость ветра:</legend>
                        <div class="form__choice-wrapper">
                            <div class="form__radio-wrapper">
                                <input class="form__radio" type="radio" id="onePC" name="PC" value="1" checked />
                                <label class="form__choice-description" for="onePC">1 день</label>
                            </div>
                            <div class="form__radio-wrapper">
                                <input class="form__radio" type="radio" id="threePC" name="PC" value="3" />
                                <label class="form__choice-description" for="threePC">3 дня</label>
                            </div>
                        </div>
                        <div class="form__chart form__chart--precipitation"></div>
                    </fieldset>
                </div>
            </div>

            <div class="main-info table-wrapper"></div>
            
            <div class="main-info">
            </div>
        </main>
        <footer class="main-footer">
            <h1 class="visually-hidden">Контакты</h1>
            <div class="main-footer__wrapper">
                <p class="main-footer__address">Поле Меньково blockhin@email.ru</p>
                <p class="main-footer__about">Программа разработана в 170 отделе ФГБНУ АФИ</p>
                <img class="main-footer__logo" src="/img/agrophysLogo.png" alt="Логотип АФИ">
            </div>
        </footer>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="_content/Blazor-ApexCharts/js/apex-charts.min.js"></script>
    <script src="/js/indexcharts.js" type="text/javascript"></script>
    <script>
        $(function () {
            var calendarButton = document.querySelector(".main-header__calendar");
            var calendarValue = calendarButton.value;

            function LoadTable(dateVal) {
                $.ajax({
                    url: '@Url.Action("_GetTable")',
                    dataType: 'html',
                    contentType: 'application/html; charset=utf-8',
                    type: 'GET',
                    data: {
                        date: dateVal
                    },
                    success: function (data) {
                        $('.table-wrapper').html(data);
                    }
                });
            }

            LoadTable(calendarValue);

            $(".main-header__calendar").on("change", function () {
                calendarValue = calendarButton.value;
                LoadTable(calendarValue);
            });
            
        });
    </script>
</body>
</html>